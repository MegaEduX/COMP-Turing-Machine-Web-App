function readSingleFile(e){var t=e.target.files[0];if(t){var a=new FileReader;a.onload=function(e){var t=e.target.result;displayContents(t)},a.readAsText(t)}}function displayContents(e){var t=window.atob(e);ace.edit("editor").setValue(t)}function createMachine(){var e=ace.edit("editor").getValue(),t=require("antlr4/index"),a=require("grammar/TuringMachineLexer.js"),n=require("grammar/TuringMachineListener.js"),r=require("grammar/TuringMachineParser.js"),i=new t.InputStream(e),c=new a.TuringMachineLexer(i),u=new t.CommonTokenStream(c),l=new r.TuringMachineParser(u);l.buildParseTrees=!0;var o=l.r(),d=new n.TuringMachineListener;t.tree.ParseTreeWalker.DEFAULT.walk(d,o),console.log(d.states);var s=document.getElementById("tape").value.split(""),g=new Machine(s,d.states,"s0");return g}function printDebugRep(){var e="",t=debugMachine.inputTape.currentIndex;debugMachine.inputTape.tape.forEach(function(a,n,r){n==t&&(e+='<span class="tm-current">'),e+=a,n==t&&(e+="</span>")}),$("#tmDebugTape").html(e)}$("#new").click(function(){var e=ace.edit("editor");e.setValue("")}),document.getElementById("file-input").addEventListener("change",readSingleFile,!1),$("#open").click(function(){$("#file-input").click()}),$("#save").click(function(){var e=window.btoa(ace.edit("editor").getValue()),t=document.createElement("a");t.href="data:application/octet-stream,"+e,t.target="_blank",t.download="TuringExport.tm",document.body.appendChild(t),t.click()});var debugMachine=null;$("#validate").click(function(){}),$("#openDebug").click(function(){debugMachine=createMachine(),$("#debug").modal("show"),$("#tmControl").html('<center><a href="#" class="btn btn-primary" id="tmDebugNext">Next</a></center>'),printDebugRep()}),$("#run").click(function(){var e=createMachine(),t=e.run();alert("Tape: ["+t.tape.compressedTape().join(" ")+"]\nResult: "+t.result)}),$("#debug").on("click","#tmDebugNext",function(){"accept"!=debugMachine.startState&&"reject"!=debugMachine.startState&&(debugMachine.step(),printDebugRep(),"accept"==debugMachine.startState?($("#tmDebugNext").html("Operation Complete - Input Accepted!"),$("#tmDebugNext").toggleClass("btn-primary"),$("#tmDebugNext").toggleClass("btn-success"),$("#tmDebugNext").attr("disabled","disabled")):"reject"==debugMachine.startState&&($("#tmDebugNext").html("Operation Complete - Input Rejected!"),$("#tmDebugNext").toggleClass("btn-primary"),$("#tmDebugNext").toggleClass("btn-danger"),$("#tmDebugNext").attr("disabled","disabled")))}),$("#exampleBinaryPalindrome").click(function(){ace.edit("editor").setValue(binaryPalindrome())});var editor=ace.edit("editor");editor.setTheme("ace/theme/chrome"),editor.setValue(binaryPalindrome()),editor.setOptions({maxLines:editor.session.getLength()});